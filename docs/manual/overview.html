<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Architecture </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Architecture ">
    <meta name="generator" content="docfx 2.59.4.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h2 id="architecture">Architecture</h2>

<p>I tried to make the plugin as accessible as possible so here we will take a look about how the asset is organized</p>
<p>This user guide was designed to provide you with the necessary information to fully understand how this plugin work. You can also find a small guide to demo inside the Demo folder that will provide you with an explanation about what each sample tries to demonstrate, it's a good way to understand it by looking directly at the commented code. ATM I'm working at a web scripting API reference, so if you are getting trouble understanding some specific API, just hit me up in discord and I'll try my best to help you.</p>
<h2 id="system-components-overview">System components overview</h2>
<p>Let's understand how the system was been architectured, we have five core classes to cover:</p>
<ul>
<li><strong>Drop table:</strong> This is our main container that will contain our drops, percentages, and amounts, together with extra information. It's a scriptable object that can be created on right-click context - <strong>right-click -&gt; Create -&gt; Drops -&gt; New Table</strong> - and control almost every aspect of our drops. This has not only our drops but also our callbacks, modifier, and filters (we will talk more about this in the specific section), and it's from where you will request drops.</li>
<li><strong>Drops:</strong> This represents your drop by itself, controlling things like your entry, percentage (in the simple and weighted scenario), amount variation, and some other settings. This exists only inside the context of a <em>Drop table</em>.</li>
<li><strong>Bag:</strong> When you request a drop from your <em>Drop table</em> you will get a Bag as result, and this will contain your randomized drops.</li>
<li><strong>Loot:</strong> When you iterate over Bag you'll get Loots, It is a limited vision of Drop that contains only the entry and a collapsed amount (by collapsed I mean, if your drop entry-amount can vary between 2 and 5, a loot will have a number between 2 and 5).</li>
<li><strong>Logic:</strong> This is the logic that will run in the background when you call for a drop using the <em>Drop Table</em>, you can inject this on each table or can use the default one that provides one version for each weighted and simple table.</li>
</ul>
<p><strong>So the flow was planned to be something like this:</strong> You will create a <em>Drop Table</em> and fill it with your <em>Drops</em>, then you can ask for a drop from your table that will run the default or custom <em>Logic</em> and you will receive a <em>Bag</em> as result, then you can iterate over your bag getting the <em>Loot</em> version of drops and populating what you were originally working on.</p>
<p>Together with classes I also want to talk about three concepts that reside in the plugin:</p>
<ul>
<li><strong>Drop table kind:</strong> In drop table inspector we can see an enum field called drop table kind. This field will change the way that drop percentage/chance is calculated</li>
</ul>
<ul>
<li>
<ul>
<li><strong>Simple:</strong> Each drop has its percentage individually, this means that when we ask for a drop, the table will try to drop each drop individually. For example, suppose that we have two drops A and B, and each one has 50% to be dropped, when we ask for a drop, our result bag can have A, A and B, B or nothing (empty bag), also changing percentage of one item will not interfere in another item percentage.</li>
<li><strong>Weighted:</strong> The percentage of each drop depends on the sum of the weight of each item, and the sum of all percentages should always be 100%, this also means that when we ask for a drop the table will give to us only one drop from the list. For example, continuing with our A and B example, if each one weights 1, this means that each has 50% to be dropped, our result bag possibilities are A or B, also if we change our B to weight 2 this will make our A change from 50% to 33% and our B change from 50% to 66%.</li>
</ul>
</li>
<li><p><strong>Modifier:</strong> This represents temporary changes that we apply to our drops in runtime that allow us to change drops properties based on custom conditions. For example, increase the drop percentage of consumables based on my sugar eat skill level. Modifiers can be applied in a global or local context, the order runs as the following:</p>
<p>​	<strong>Global modify</strong> =&gt; <strong>Global modified</strong> =&gt; <strong>Local modify</strong> =&gt; <strong>Local modified</strong> =&gt; (<strong>Filter part</strong>)</p>
<p>OBS: xxxModify happen for every item while xxxModified happen one time, so if your modify condition depends on some value that needs to be counted every time, use the modified event version</p>
<ul>
<li><strong>Global modify:</strong>
<ul>
<li>It's raised one time for every drop.</li>
<li>It's shared between all tables.</li>
<li>It's an Action<modifyeventargs></modifyeventargs></li>
</ul>
</li>
<li><strong>Global modified:</strong>
<ul>
<li>It's raised one time, after all, modify actions finished being applied.</li>
<li>It's shared between all tables.</li>
<li>It's an Action<modifiedeventargs></modifiedeventargs></li>
</ul>
</li>
<li><strong>Local modify:</strong>
<ul>
<li>It's raised one time for every drop.</li>
<li>It's individual to each table.</li>
<li>It's an Action<modifyeventargs></modifyeventargs></li>
</ul>
</li>
<li><strong>Local modified:</strong>
<ul>
<li>It's raised one time, after all, modify finished being applied.</li>
<li>It's individual to each table.</li>
<li>It's an Action<modifiedeventargs>.</modifiedeventargs></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Filter drops:</strong> This will allow us to temporarily filter our drops. For example, in N attempt make sure that users receive at least one of this specific item type in their drop. Filters happen after the modifiers was applied, this means that your condition is based on a modified version of your table.</p>
<ul>
<li><strong>Filter:</strong> This will remove the drop from the collection if ANY listener returns false.
<ul>
<li>It's raised one time for every drop.</li>
<li>It's individual to each table.</li>
<li>It's an Predicate<filtereventargs>.</filtereventargs></li>
</ul>
</li>
<li><strong>Filtered:</strong> It's the last thing to be applied, so the list of drops at this point is already modified and filtered
<ul>
<li>It's raised one time.</li>
<li>It's individual to each table.</li>
<li>It's an Action<filteredeventargs>.</filteredeventargs></li>
</ul>
</li>
</ul>
</li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/Nefisto/Loot-doc/blob/main/manual/overview.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <div class="toggle-mode">
                <div class="icon">
                  <i aria-hidden="true">☀</i>
                </div>
                <label class="switch">
                  <input type="checkbox" id="switch-style">
                  <span class="slider round"></span>
                </label>
                <div class="icon">
                  <i aria-hidden="true">☾</i>
                </div>
              </div>
          
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <h5>In This Article</h5>
              <div></div>
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <div class="pull-left">
              
              <span>Generated by <strong>DocFX</strong></span>
            </div>
            <div class="toggle-mode pull-right visible-sm visible-xs">
              <div class="icon">
                <i aria-hidden="true">☀</i>
              </div>
              <label class="switch">
                <input type="checkbox" id="switch-style-m">
                <span class="slider round"></span>
              </label>
              <div class="icon">
                <i aria-hidden="true">☾</i>
              </div>
            </div>
          </div>
        </div>
        <script type="text/javascript" src="../styles/toggle-theme.js"></script>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
